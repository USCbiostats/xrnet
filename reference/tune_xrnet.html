<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>k-fold cross-validation for hierarchical regularized regression — tune_xrnet • xrnet</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="k-fold cross-validation for hierarchical regularized regression — tune_xrnet"><meta name="description" content="k-fold cross-validation for hierarchical regularized
regression xrnet"><meta property="og:description" content="k-fold cross-validation for hierarchical regularized
regression xrnet"><meta property="og:image" content="https://uscbiostats.github.io/xrnet/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xrnet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/USCbiostats/xrnet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>k-fold cross-validation for hierarchical regularized regression</h1>
      <small class="dont-index">Source: <a href="https://github.com/USCbiostats/xrnet/blob/v1.0.0/R/tune_xrnet.R" class="external-link"><code>R/tune_xrnet.R</code></a></small>
      <div class="d-none name"><code>tune_xrnet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>k-fold cross-validation for hierarchical regularized
regression <code><a href="xrnet.html">xrnet</a></code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tune_xrnet</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  external <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unpen <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"binomial"</span><span class="op">)</span>,</span>
<span>  penalty_main <span class="op">=</span> <span class="fu"><a href="define_penalty.html">define_penalty</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  penalty_external <span class="op">=</span> <span class="fu"><a href="define_penalty.html">define_penalty</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  standardize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  loss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"mse"</span>, <span class="st">"mae"</span>, <span class="st">"auc"</span><span class="op">)</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  foldid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>predictor design matrix of dimension \(n x p\), matrix options
include:</p><ul><li><p>matrix</p></li>
<li><p>big.matrix</p></li>
<li><p>filebacked.big.matrix</p></li>
<li><p>sparse matrix (dgCMatrix)</p></li>
</ul></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>outcome vector of length \(n\)</p></dd>


<dt id="arg-external">external<a class="anchor" aria-label="anchor" href="#arg-external"></a></dt>
<dd><p>(optional) external data design matrix of dimension
\(p x q\), matrix options include:</p><ul><li><p>matrix</p></li>
<li><p>sparse matrix (dgCMatrix)</p></li>
</ul></dd>


<dt id="arg-unpen">unpen<a class="anchor" aria-label="anchor" href="#arg-unpen"></a></dt>
<dd><p>(optional) unpenalized predictor design matrix, matrix options
include:</p><ul><li><p>matrix</p></li>
</ul></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>error distribution for outcome variable, options include:</p><ul><li><p>"gaussian"</p></li>
<li><p>"binomial"</p></li>
</ul></dd>


<dt id="arg-penalty-main">penalty_main<a class="anchor" aria-label="anchor" href="#arg-penalty-main"></a></dt>
<dd><p>specifies regularization object for x. See
<code><a href="define_penalty.html">define_penalty</a></code> for more details.</p></dd>


<dt id="arg-penalty-external">penalty_external<a class="anchor" aria-label="anchor" href="#arg-penalty-external"></a></dt>
<dd><p>specifies regularization object for external. See
<code><a href="define_penalty.html">define_penalty</a></code> for more details.
See <code><a href="define_penalty.html">define_penalty</a></code> for more details.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>optional vector of observation-specific weights.
Default is 1 for all observations.</p></dd>


<dt id="arg-standardize">standardize<a class="anchor" aria-label="anchor" href="#arg-standardize"></a></dt>
<dd><p>indicates whether x and/or external should be
standardized. Default is c(TRUE, TRUE).</p></dd>


<dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>indicates whether an intercept term is included for x and/or
external. Default is c(TRUE, FALSE).</p></dd>


<dt id="arg-loss">loss<a class="anchor" aria-label="anchor" href="#arg-loss"></a></dt>
<dd><p>loss function for cross-validation. Options include:</p><ul><li><p>"deviance"</p></li>
<li><p>"mse" (Mean Squared Error)</p></li>
<li><p>"mae" (Mean Absolute Error)</p></li>
<li><p>"auc" (Area under the curve)</p></li>
</ul></dd>


<dt id="arg-nfolds">nfolds<a class="anchor" aria-label="anchor" href="#arg-nfolds"></a></dt>
<dd><p>number of folds for cross-validation. Default is 5.</p></dd>


<dt id="arg-foldid">foldid<a class="anchor" aria-label="anchor" href="#arg-foldid"></a></dt>
<dd><p>(optional) vector that identifies user-specified fold for each
observation. If NULL, folds are automatically generated.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>use <code>foreach</code> function to fit folds in parallel if TRUE,
must register cluster (<code>doParallel</code>) before using.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>specifies xrnet control object. See
<code><a href="xrnet_control.html">xrnet_control</a></code> for more details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>tune_xrnet</code> with components</p>
<dl><dt>cv_mean</dt>
<dd><p>mean cross-validated error for each penalty combination.
Object returned is a vector if there is no external data (external = NULL)
and matrix if there is external data.</p></dd>

<dt>cv_sd</dt>
<dd><p>estimated standard deviation for cross-validated errors.
Object returned is a vector if there is no external data (external = NULL)
and matrix if there is external data.</p></dd>

<dt>loss</dt>
<dd><p>loss function used to compute cross-validation error</p></dd>

<dt>opt_loss</dt>
<dd><p>the value of the loss function for the optimal
cross-validated error</p></dd>

<dt>opt_penalty</dt>
<dd><p>first-level penalty value that achieves the optimal loss</p></dd>

<dt>opt_penalty_ext</dt>
<dd><p>second-level penalty value that achieves the optimal
loss (if external data is present)</p></dd>

<dt>fitted_model</dt>
<dd><p>fitted xrnet object using all data, see
<code><a href="xrnet.html">xrnet</a></code> for details of object</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>k-fold cross-validation is used to determine the 'optimal'
combination of hyperparameter values, where optimal is based on the optimal
value obtained for the user-selected loss function across the k folds. To
efficiently traverse all possible combinations of the hyperparameter values,
'warm-starts' are used to traverse the penalty from largest to smallest
penalty value(s). Note that the penalty grid for the folds is generated
by fitting the model on the entire training data. Parallelization is enabled
through the <code>foreach</code> and <code>doParallel</code> R packages. To use
parallelization, <code>parallel = TRUE</code>, you must first create the cluster
<code>makeCluster</code> and then register the cluster <code>registerDoParallel</code>.
See the <code>parallel</code>, <code>foreach</code>, and/or <code>doParallel</code> R packages
for more details on how to setup parallelization.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## cross validation of hierarchical linear regression model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">GaussianExample</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 5-fold cross validation</span></span></span>
<span class="r-in"><span><span class="va">cv_xrnet</span> <span class="op">&lt;-</span> <span class="fu">tune_xrnet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x_linear</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">y_linear</span>,</span></span>
<span class="r-in"><span>  external <span class="op">=</span> <span class="va">ext_linear</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="xrnet_control.html">xrnet_control</a></span><span class="op">(</span>tolerance <span class="op">=</span> <span class="fl">1e-6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## contour plot of cross-validated error</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv_xrnet</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tune_xrnet-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Garrett Weaver, Dixin Shen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

