<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit hierarchical regularized regression model — xrnet • xrnet</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit hierarchical regularized regression model — xrnet"><meta name="description" content="Fits hierarchical regularized regression model that enables the
incorporation of external data for predictor variables. Both the predictor
variables and external data can be regularized by the most common penalties
(lasso, ridge, elastic net). Solutions are computed across a two-dimensional
grid of penalties (a separate penalty path is computed for the predictors and
external variables). Currently support regularized linear and logistic
regression, future extensions to other outcomes (i.e. Cox regression) will be
implemented in the next major update."><meta property="og:description" content="Fits hierarchical regularized regression model that enables the
incorporation of external data for predictor variables. Both the predictor
variables and external data can be regularized by the most common penalties
(lasso, ridge, elastic net). Solutions are computed across a two-dimensional
grid of penalties (a separate penalty path is computed for the predictors and
external variables). Currently support regularized linear and logistic
regression, future extensions to other outcomes (i.e. Cox regression) will be
implemented in the next major update."><meta property="og:image" content="https://uscbiostats.github.io/xrnet/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xrnet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/USCbiostats/xrnet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit hierarchical regularized regression model</h1>
      <small class="dont-index">Source: <a href="https://github.com/USCbiostats/xrnet/blob/master/R/xrnet.R" class="external-link"><code>R/xrnet.R</code></a></small>
      <div class="d-none name"><code>xrnet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits hierarchical regularized regression model that enables the
incorporation of external data for predictor variables. Both the predictor
variables and external data can be regularized by the most common penalties
(lasso, ridge, elastic net). Solutions are computed across a two-dimensional
grid of penalties (a separate penalty path is computed for the predictors and
external variables). Currently support regularized linear and logistic
regression, future extensions to other outcomes (i.e. Cox regression) will be
implemented in the next major update.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">xrnet</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  external <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unpen <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"binomial"</span><span class="op">)</span>,</span>
<span>  penalty_main <span class="op">=</span> <span class="fu"><a href="define_penalty.html">define_penalty</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  penalty_external <span class="op">=</span> <span class="fu"><a href="define_penalty.html">define_penalty</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  standardize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>predictor design matrix of dimension \(n x p\), matrix options
include:</p><ul><li><p>matrix</p></li>
<li><p>big.matrix</p></li>
<li><p>filebacked.big.matrix</p></li>
<li><p>sparse matrix (dgCMatrix)</p></li>
</ul></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>outcome vector of length \(n\)</p></dd>


<dt id="arg-external">external<a class="anchor" aria-label="anchor" href="#arg-external"></a></dt>
<dd><p>(optional) external data design matrix of dimension
\(p x q\),
matrix options include:</p><ul><li><p>matrix</p></li>
<li><p>sparse matrix (dgCMatrix)</p></li>
</ul></dd>


<dt id="arg-unpen">unpen<a class="anchor" aria-label="anchor" href="#arg-unpen"></a></dt>
<dd><p>(optional) unpenalized predictor design matrix, matrix options
include:</p><ul><li><p>matrix</p></li>
</ul></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>error distribution for outcome variable, options include:</p><ul><li><p>"gaussian"</p></li>
<li><p>"binomial"</p></li>
</ul></dd>


<dt id="arg-penalty-main">penalty_main<a class="anchor" aria-label="anchor" href="#arg-penalty-main"></a></dt>
<dd><p>specifies regularization object for x. See
<code><a href="define_penalty.html">define_penalty</a></code> for more details.</p></dd>


<dt id="arg-penalty-external">penalty_external<a class="anchor" aria-label="anchor" href="#arg-penalty-external"></a></dt>
<dd><p>specifies regularization object for external. See
<code><a href="define_penalty.html">define_penalty</a></code> for more details.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>optional vector of observation-specific weights. Default is 1
for all observations.</p></dd>


<dt id="arg-standardize">standardize<a class="anchor" aria-label="anchor" href="#arg-standardize"></a></dt>
<dd><p>indicates whether x and/or external should be
standardized. Default is c(TRUE, TRUE).</p></dd>


<dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>indicates whether an intercept term is included for x
and/or external. Default is c(TRUE, FALSE).</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>specifies xrnet control object. See
<code><a href="xrnet_control.html">xrnet_control</a></code> for more details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>xrnet</code> with components:</p>
<dl><dt>beta0</dt>
<dd><p>matrix of first-level intercepts indexed by penalty values</p></dd>

<dt>betas</dt>
<dd><p>3-dimensional array of first-level penalized coefficients
indexed by penalty values</p></dd>

<dt>gammas</dt>
<dd><p>3-dimensional array of first-level non-penalized coefficients
indexed by penalty values</p></dd>

<dt>alpha0</dt>
<dd><p>matrix of second-level intercepts indexed by penalty values</p></dd>

<dt>alphas</dt>
<dd><p>3-dimensional array of second-level external data coefficients
indexed by penalty values</p></dd>

<dt>penalty</dt>
<dd><p>vector of first-level penalty values</p></dd>

<dt>penalty_ext</dt>
<dd><p>vector of second-level penalty values</p></dd>

<dt>family</dt>
<dd><p>error distribution for outcome variable</p></dd>

<dt>num_passes</dt>
<dd><p>total number of passes over the data in the coordinate
descent algorithm</p></dd>

<dt>status</dt>
<dd><p>error status for xrnet fitting</p></dd>

</dl><ul><li><p>0 = OK</p></li>
<li><p>1 = Error/Warning</p></li>
</ul><dl><dt>error_msg</dt>
<dd><p>description of error</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function extends the coordinate descent algorithm of the
R package <code>glmnet</code> to allow the type of regularization (i.e. ridge,
lasso) to be feature-specific. This extension is used to enable fitting
hierarchical regularized regression models, where external information for
the predictors can be included in the <code>external=</code> argument. In addition,
elements of the R package <code>biglasso</code> are utilized to enable the use of
standard R matrices, memory-mapped matrices from the <code>bigmemory</code>
package, or sparse matrices from the <code>Matrix</code> package.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jerome Friedman, Trevor Hastie, Robert Tibshirani (2010).
Regularization Paths for Generalized Linear Models via Coordinate Descent.
Journal of Statistical Software, 33(1), 1-22. URL
http://www.jstatsoft.org/v33/i01/.</p>
<p>Zeng, Y., and Breheny, P. (2017).
The biglasso Package: A Memory- and Computation-Efficient Solver for Lasso
Model Fitting with Big Data in R. arXiv preprint arXiv:1701.05936. URL
https://arxiv.org/abs/1701.05936.</p>
<p>Michael J. Kane, John Emerson, Stephen Weston (2013).
Scalable Strategies for Computing with Massive Data.
Journal of Statistical Software, 55(14), 1-19. URL
http://www.jstatsoft.org/v55/i14/.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### hierarchical regularized linear regression ###</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">GaussianExample</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## define penalty for predictors and external variables</span></span></span>
<span class="r-in"><span><span class="co">## default is ridge for predictors and lasso for external</span></span></span>
<span class="r-in"><span><span class="co">## see define_penalty() function for more details</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">penMain</span> <span class="op">&lt;-</span> <span class="fu"><a href="define_penalty.html">define_penalty</a></span><span class="op">(</span><span class="fl">0</span>, num_penalty <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">penExt</span> <span class="op">&lt;-</span> <span class="fu"><a href="define_penalty.html">define_penalty</a></span><span class="op">(</span><span class="fl">1</span>, num_penalty <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## fit model with defined regularization</span></span></span>
<span class="r-in"><span><span class="va">fit_xrnet</span> <span class="op">&lt;-</span> <span class="fu">xrnet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x_linear</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">y_linear</span>,</span></span>
<span class="r-in"><span>  external <span class="op">=</span> <span class="va">ext_linear</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span></span>
<span class="r-in"><span>  penalty_main <span class="op">=</span> <span class="va">penMain</span>,</span></span>
<span class="r-in"><span>  penalty_external <span class="op">=</span> <span class="va">penExt</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Garrett Weaver, Dixin Shen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

